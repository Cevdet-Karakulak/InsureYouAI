@model List<PolicyGroupViewModel>

@{
    var total = Model.Sum(x => x.Count);
}

<div class="col-12 col-lg-6 col-xl-6 d-flex">
    <div class="card rounded-4 w-100">
        <div class="card-body">
            <div class="d-flex align-items-center mb-3">
                <h6 class="mb-0">En Cok Satilan Policeler</h6>
                <div class="fs-5 ms-auto dropdown">
                    <div class="dropdown-toggle dropdown-toggle-nocaret cursor-pointer" data-bs-toggle="dropdown">
                        <i class="bi bi-three-dots"></i>
                    </div>
                </div>
            </div>

            <div>
                @foreach (var item in Model)
                {
                    var percentage = (int)((item.Count * 100.0) / total);

                    string img = item.PolicyType switch
                    {
                        "Egitim" => "/policyicons/egitim.png",
                        "Kasko" => "/policyicons/kasko.png",
                        "Konut" => "/policyicons/konut.png",
                        "Sağlık" => "/policyicons/saglik.png",
                        "Trafik" => "/policyicons/trafik.png",
                        _ => "/policyicons/egitim.png"
                    };

                    <div class="d-flex align-items-start gap-3">

                        <div class="product-box border">
                            <img src="@img" alt="policy img" style="width:48px;height:48px;">
                        </div>

                        <div class="flex-grow-1">
                            <div class="progress-wrapper">

                                <p class="my-2 d-flex justify-content-between">
                                    <span>@item.PolicyType</span>

                                    <span>
                                        (@item.Count Police Satisi)
                                        <span style="font-weight:700; color:#000;">@percentage%</span>
                                    </span>
                                </p>

                                <div class="progress" style="height: 6px;">
                                    <div class="progress-bar bg-primary"
                                         role="progressbar"
                                         style="width:@percentage%">
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>

                    <hr />
                }
            </div>

        </div>
    </div>
</div>
